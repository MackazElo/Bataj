<!doctype html>
<style>
    :root {
        --main-background: #fffdfd;
        --secondary-background: #f2f0f0;
        --hover-background: #a3a3a3;

        --main-font: #15131c;
        --disabled-font: #777777;

        --main-border: #15131c;
        --secondary-border: #777777;


        --main-blue: #3b18f7;
        --main-green: #006e05;
        --secondary-green: #1d4821;

    }

    /* reset css */
    ::-moz-selection {
        background: rgb(202, 202, 202);
    }

    ::selection {
        background: rgb(174, 174, 174);
    }

    body,
    div,
    dl,
    dt,
    dd,
    ul,
    ol,
    li,
    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    pre,
    form,
    fieldset,
    input,
    textarea,
    p,
    blockquote,
    th,
    td {
        margin: 0;
        padding: 0;
    }

    html,
    body {
        margin: 0;
        padding: 0;
        font-family: 'Roboto Mono', monospace;
        min-width: 500px;
    }

    table {
        border-collapse: collapse;
        border-spacing: 0;
    }

    fieldset,
    img {
        border: 0;
    }

    input {
        border: 1px solid #b0b0b0;
        padding: 3px 5px 4px;
        color: #979797;
        width: 190px;
    }

    address,
    caption,
    cite,
    code,
    dfn,
    th,
    var {
        font-style: normal;
        font-weight: normal;
    }

    ol,
    ul {
        list-style: none;
    }

    caption,
    th {
        text-align: left;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        font-size: 100%;
        font-weight: normal;
    }

    /* Chrome, Safari, Edge, Opera */
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }

    /* Firefox */
    input[type=number] {
        appearance: textfield;
    }

    .hidden {
        visibility: hidden;
        display: none !important;
        height: 0 !important;
        width: 0 !important;
        background-color: red;
    }

    /* end reset css */
    /* ------------------------ */


    .content {
        width: 100%;
        height: 100%;
        background-color: var(--main-background);
    }

    /* ------------------------ */
    .benchmark {
        padding-top: 30px;
        padding-left: 30px;
        padding-right: 30px;
        padding-bottom: 18px;
        box-shadow: rgba(0, 0, 0, .1) 0px -10px 10px;
        min-width: 440px;
    }

    .local-player,
    .youtube-player {
        flex-direction: column;
        justify-content: center;
        text-align: center;
        max-width: 410px;
        padding: 0;
        padding-bottom: 25px;
        margin-left: auto;
        margin-right: auto;
        border: 1px solid var(--main-border);
    }

    .local-player h1,
    .youtube-player h1 {
        padding-top: 15px;
        padding-bottom: 15px;
    }
    .local-player video {
        width: 100%;
        min-height: 220px;
    }

    .youtube-player iframe {
        width: 100%;
        aspect-ratio: 16 / 9;
    }

    /* ------------------------ */


    .table {
        height: 100%;
        top: 0;
        right: 0;
        background-color: #eeeeee;
        table-layout: auto;
        width: 100%;
        font-size: 1em;
    }

    .table table {
        table-layout: auto;
        width: 100%;
    }

    .table-content th {
        text-align: center;
        font-weight: bold;
    }

    .repai-head {
        text-align: left !important;
    }

    .table-content th:last-child {
        padding-right: 10px;
    }

    .table-content thead tr {
        border-bottom: 0;
    }
    .table-content thead tr th {
        background-color: var(--main-border);
        color: var(--main-background);
        position: sticky;
        top: 35px;
    }

    .table-content thead tr {
        height: 35px;
    }

    .table-content thead {
        height: 35px !important;
    }

    .table-content th {
        height: 35px;
        padding: 0;
    }

    .table-content td,
    .table-content tr {
        word-wrap: break-word;
    }

    .repair-head,
    .repair-table {
        max-width: 100px;
    }

    .repair-table a {
        color: var(--main-font);
    }

    .repair-table a:hover {
        font-weight: bold;
    }

    .id-head,
    .id-table {
        width: 60px;
        text-align: center;
    }

    .health-head,
    .health-table,
    .cycle-head,
    .cycle-table,
    .level-head,
    .level-table {
        width: 90px;
        text-align: center;
    }

    .table-content tr:nth-child(2n+1) {
        background-color: var(--main-background);

    }

    .table-content tr {
        background-color: var(--secondary-background);
        border-bottom: 1px solid var(--main-border);
        height: 35px;
    }
    .table-repair,
    .table-health,
    .table-cycle,
    .table-level {
        text-align: center;
    }
    .navbar {
        background-color: var(--main-border);
        height: 35px;
        width: 100%;
        position: sticky;
        top: 0;
        z-index: 11;

    }
    .navbar-list {
        display: flex;
    }
    .navbar-list li {
        padding: 8px;
        margin: 0 15px;
        color: var(--main-background);
        font-weight: bold;
    }

    .benchmark-forms {
        background-color: var(--main-background);
        color: var(--main-font);
        border: 1px solid var(--main-border);
        overflow: hidden;
        display: flex;
        align-items: center;
        flex-direction: column;
        margin-left: auto;
        margin-right: auto;
        margin-bottom: 30px;
        padding: 15px 5px 22px;
        max-width: 400px;
    }

    .benchmark-forms:hover {
        max-height: 600px;
    }

    .benchmark-forms form {
        width: 380px;
    }

    .benchmark-forms input {
        border: 1px solid var(--secondary-border);
        background-color: var(--main-background);
        border-radius: 6px;
        padding: 8px;
        margin: 0;
        width: 100%;
        font-size: 1em;
        color: var(--main-font);
        box-sizing: border-box;
        font-family: 'Roboto Mono', monospace;
        margin-bottom: 12px;
        margin-top: 2px;
        transition: .1s;
    }

    .benchmark-forms input:hover {
        background-color: var(--secondary-background);
        transition: .1s;
        border-color: var(--main-border);

    }

    .benchmark-forms input:focus {
        border: 1px solid var(--main-border);
        border-radius: 6px;
        outline: none;
        transition: .1s;
        background-color: var(--secondary-background);
    }

    .hide-info {
        overflow: hidden;
        padding: 4px 10px;
        max-width: 290px;
        border-right: 1px solid var(--main-border);
    }

    .hide-time {
        padding: 4px 12px;
        min-width: 170px;
    }
    #Comment_input {
        font-size: 1em;
        height: 100%;
        padding: 8px;
    }
    .benchmark-forms input::placeholder {
        color: #777777;
    }
    .benchmark-radios input[type="radio"] {
        opacity: 0;
        position: fixed;
        width: 0;
        user-select: none;
    }
    .benchmark-radios {
        margin-top: 2px;
        padding-bottom: 12px;
    }
    .benchmark-radios label,
    .benchmark-button {
        user-select: none;
        background-color: var(--main-background);
        display: inline-block;
        text-align: center;
        padding: 8px 0;
        font-size: 1em;
        border: 1px solid var(--disabled-font);
        border-radius: 6px;
        color: var(--disabled-font);
        transition: .1s;
        box-shadow: rgba(0, 0, 0, 0.1) 0px 4px 12px;
    }
    .benchmark-radios label:nth-child(4) {
        margin: 0 2px;
    }
    .benchmark-radios .benchmark-button:nth-child(2) {
        margin: 0 3px;
    }
    .benchmark-button {
        cursor: pointer;
    }
    .benchmark-button:hover {
        transition: .1s;
        border-color: var(--main-border);
        color: var(--main-font);
    }
    .active-section:hover {
        color: var(--main-background);
    }
    .benchmark-radios input[type="radio"]:checked+label,
    .benchmark-button:active,
    .active-section {
        color: var(--main-background);
        background-color: var(--main-border);
        border-color: var(--main-border);
    }
    .benchmark-radios label:hover {
        cursor: pointer;
        color: var(--main-font);
        border-color: var(--main-border);

        background-color: var(--secondary-background);
    }
    #radio-s:disabled+label,
    #radio-c:disabled+label,
    #radio-other:disabled+label,
    .benchmark-forms-input:disabled {
        cursor: not-allowed;
        color: var(--disabled-font);
        border-color: var(--disabled-font);
        background-color: var(--secondary-background);
    }
    .benchmark-radios {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        grid-template-rows: 1fr;
        grid-column-gap: 0px;
        grid-row-gap: 0px;
    }
    .activeMode {
        background-color: var(--main-green) !important;
        color: var(--main-background);
        transition: color 200ms ease-in-out;
    }
    .stopMode {
        background-color: #b72b18 !important;
        color: var(--main-background);
        transition: color 200ms ease-in-out;
    }
    .activeMode:hover,
    .stopMode:hover {
        color: #ffffffa8 !important;
    }
    #start_button {
        box-sizing: border-box;
        margin-top: 10px;
        font-size: 1.1em;
        color: var(--main-background);
        border: 1px solid var(--main-border);
        border-radius: 6px;
        padding: 14px 18px;
        background-color: var(--main-border);
        width: 100%;
        height: 52px;
        max-width: 400px;
        cursor: pointer !important;
        box-shadow: rgba(0, 0, 0, 0.1) 0px 4px 12px;
    }

    #start_button:hover {
        background-color: var(--main-background);
        color: var(--main-font);
    }

    /* ------------------------ */
    footer {
        height: 3em;
    }


    /* ------------------------ */

    /* table */
    .hidden_row {
        display: none;
        background-color: var(--secondary-background) !important;
        height: 60px !important;
        text-align: left;
        vertical-align: top;
    }
    .table-info {
        width: 10px !important;
    }
    .active {
        background-color: var(--secondary-background) !important;
    }
    @media only screen and (min-width: 992px) {
        .benchmark-video {
            margin-left: auto;
            margin-right: auto;
        }

        body {
            overflow-y: hidden;
        }
        .content {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-column-gap: 0px;
            grid-row-gap: 0px;
            height: calc(100vh - 35px);
        }
        .benchmark {
            overflow: scroll;
        }
        .table {
            margin-top: -35px;
            top: -10px;
            z-index: 11;
        }
        .table {
            overflow: scroll;
            height: calc(100% + 39px);

        }
        .table-content tr {
            box-shadow: inset 21px 4px 39px -50px rgba(0, 0, 0, 1);
        }
        .table-content thead tr th {
            top: 0;
        }
    }
</style>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://code.jquery.com/jquery-3.6.0.js"
        integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <script src="https://cdn.datatables.net/1.12.0/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.12.0/js/dataTables.bootstrap5.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <title>BATAJ</title>
</head>

<body>
    <input id="iteration" value="0" hidden>
    <nav class="navbar">
        <ul class="navbar-list">
            <li>home page</li>
        </ul>
    </nav>
    <div class="content">
        <div class="benchmark">
            <div class="benchmark-radios" id="Comment_select">
                <div class="benchmark-button form-button" tabindex="0" onclick="changeSection('f')">formularz</div>
                <div class="benchmark-button youtube-button" tabindex="0" onclick="changeSection('y')">youtube</div>
                <div class="benchmark-button local-button" tabindex="0" onclick="changeSection('l')">local</div>
            </div>

            <div class="benchmark-forms hidden">
                <h1>battery benchmark</h1>

                <form method="post" id="form_new">
                    <span class="benchmark-forms-label">typ testu</span>

                    <div class="benchmark-radios" onchange="move_Select()" id="Comment_select">
                        <input type="radio" id="radio-c" name="benchmark-radio" value="kalibracja" checked>
                        <label tabindex="0" for="radio-c">kalibracja</label>
                        <input type="radio" id="radio-s" name="benchmark-radio" value="stabilność">
                        <label tabindex="0" for="radio-s">stabilność</label>
                        <input type="radio" id="radio-other" name="benchmark-radio" value="inne">
                        <label tabindex="0" for="radio-other">inne</label>
                    </div>
                    <input name="Comment" id="Comment_input" class="benchmark-forms-input hidden"
                        placeholder="wpisz typ testu">
                    <span class="benchmark-forms-label">numer naprawy</span>
                    <input type="number" class="benchmark-forms-input repair" name="Repair" value=""
                        placeholder="np. 35423" min="0" max="999999" required>
                    <span class="benchmark-forms-label">naładowanie baterii</span>
                    <input class="benchmark-forms-input level" name="Level" type="number" min="0" max="100" value="100">
                    <span class="benchmark-forms-label">kondycja baterii</span>
                    <input class="benchmark-forms-input health" name="Health" type="number" min="0" max="100"
                        value="100">
                    <span class="benchmark-forms-label">który cykl</span>
                    <input class="benchmark-forms-input cycle" name="Cycle" type="number" min="0" value="0">

                    <input name="Start" value="" hidden>
                    <input name="Last" value="" hidden>
                    <input name="action" value="Start" hidden>
                    <input type="submit" id="submit_new" value="new" hidden>
                    <input type="button" value="uruchom test" id="start_button" onclick="runner()">
                </form>
                <form method="post" id="form_update" hidden>
                    <input id="current_id" name="id" value="0">
                    <input name="action" value="Now" hidden>
                    <input type="submit" id="submit_update" value="update">
                </form>
                <input type="button" id='refresh' value="refresh" hidden>
                <input id="run" value="0" hidden>
            </div>

            <div class="benchmark-video">
                <div class="youtube-player hidden">
                    <h1>youtube player</h1>
                    <iframe src="https://www.youtube.com/embed/a6GGZ68mOZA" title="seels 10 hours" frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                        allowfullscreen></iframe>
                </div>
                <div class="local-player hidden">
                    <h1>local video player</h1>
                    <video controls loop muted>
                        <source src="seals.mp4" type="video/mp4">
                    </video>
                </div>
            </div>
        </div>

        <div class="table">
            <div class="table-content">
                <table class="" id="sample_data">
                    <thead>
                        <tr>
                            <th class="id-head">id</th>
                            <th class="repai-head">repair</th>
                            <th class="health-head">health</th>
                            <th class="cycle-head">cycle</th>
                            <th class="level-head">level</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>
    </form>
    </div>
    </div>
    </div>

    <script>
        // const LOCALHOST = ""

        function showHideRow(row) {
            $("#" + row).toggle();
            document.getElementsByClassName(`table-id-${row}`)[0].parentElement.classList.toggle("active")
        }
        function move_Select() {
            // let coment_radio = document.getElementById("Comment_select")
            // let coment_input = document.getElementById("Comment_input")
            if (document.getElementById('radio-other').checked) {
                document.getElementById("Comment_input").classList.remove("hidden");
                document.getElementById("Comment_input").focus();
                document.getElementById("Comment_input").value = "";
            }
            else if (document.getElementById('radio-s').checked) {
                document.getElementById("Comment_input").classList.add("hidden")
                document.getElementById("Comment_input").value = "stabilność"
            }
            else if (document.getElementById('radio-c').checked) {
                document.getElementById("Comment_input").classList.add("hidden")
                document.getElementById("Comment_input").value = "kalibracja"
            }
        }
        move_Select();

        function changeSection(tryb) {
            const form = document.getElementsByClassName("benchmark-forms")[0]
            const youtube = document.getElementsByClassName("youtube-player")[0]
            const local = document.getElementsByClassName("local-player")[0]
            const formButton = document.getElementsByClassName("form-button")[0]
            const youtubeButton = document.getElementsByClassName("youtube-button")[0]
            const localButton = document.getElementsByClassName("local-button")[0]

            if (tryb == "f") {
                formButton.classList.add("active-section")
                youtubeButton.classList.remove("active-section")
                localButton.classList.remove("active-section")

                form.classList.remove("hidden")
                youtube.classList.add("hidden")
                local.classList.add("hidden")
            }
            if (tryb == "y") {
                formButton.classList.remove("active-section")
                youtubeButton.classList.add("active-section")
                localButton.classList.remove("active-section")

                form.classList.add("hidden")
                youtube.classList.remove("hidden")
                local.classList.add("hidden")
            }
            if (tryb == "l") {
                formButton.classList.remove("active-section")
                youtubeButton.classList.remove("active-section")
                localButton.classList.add("active-section")

                form.classList.add("hidden")
                youtube.classList.add("hidden")
                local.classList.remove("hidden")
            }
        }
        changeSection('f');



        function runner() {
            var mode = document.getElementById("run")
            var but = document.getElementById("start_button")
            const formButton = document.getElementsByClassName('form-button')[0]

            if (mode.value == "1") {
                document.getElementsByClassName('level')[0].disabled = false
                document.getElementsByClassName('health')[0].disabled = false
                document.getElementsByClassName('repair')[0].disabled = false
                document.getElementsByClassName('cycle')[0].disabled = false
                document.getElementById("radio-s").disabled = false
                document.getElementById("radio-c").disabled = false
                document.getElementById("radio-other").disabled = false

                mode.value = 0

                but.classList.add('stopMode')
                formButton.classList.add('stopMode')
                but.classList.remove('activeMode')
                formButton.classList.remove('activeMode')

                but.value = 'Test zakończony, kliknij aby uruchomić ponownie'
            }
            else if (mode.value == "0") {
                mode.value = 1

                but.classList.add('activeMode')
                formButton.classList.add('activeMode')
                but.classList.remove('stopMode')
                formButton.classList.remove('stopMode')

                but.value = 'Test trwa, kliknij aby zakońćzyć'
                document.getElementById("submit_new").click()

                document.getElementsByClassName('level')[0].disabled = true
                document.getElementsByClassName('health')[0].disabled = true
                document.getElementsByClassName('repair')[0].disabled = true
                document.getElementsByClassName('cycle')[0].disabled = true
                document.getElementById("radio-s").disabled = true
                document.getElementById("radio-c").disabled = true
                document.getElementById("radio-other").disabled = true
                timeout = setTimeout(update_id, 10000);
                timeout = setTimeout(send, 10000);
            }
        }

        function update_id() {
            var oTable = document.getElementById('sample_data');
            var rowLength = oTable.rows.length;
            var oCells = oTable.rows.item(1).cells;
            var cellLength = oCells.length;
            var cellVal = oCells.item(0).innerHTML;
            document.getElementById("current_id").value = cellVal;
        }

        function send() {
            document.getElementById("submit_update").click()
            var i = document.getElementById("iteration").value
            i++
            document.getElementById("iteration").value = i
            if (document.getElementById("run").value == 1) {
                timeout = setTimeout(send, 30000);
            }
        }

        function autoload() {
            document.getElementById('refresh').click()
            timeout = setTimeout(autoload, 60000);
        }
        autoload()

        function dif(strt, now) {
            strt = new Date(strt)
            now = new Date(now)
            var s = strt - now
            function pad(n, z) {
                z = z || 2;
                return ('00' + n * -1).slice(-z);
            }

            var ms = s % 1000;
            s = (s - ms) / 1000;
            var secs = s % 60;
            s = (s - secs) / 60;
            var mins = s % 60;
            var hrs = (s - mins) / 60;

            return pad(hrs) + 'h:' + pad(mins) + 'm';
        }

    </script>


    <script>

        $(document).ready(function () {

            load_data();
            function load_data() {
                function getRandomDate() {
                    const maxDate = Date.now();
                    const timestamp = Math.floor(Math.random() * (maxDate - 1685455020000) + 1685455020000);
                    const retDate = new Date(timestamp);
                    return retDate.setSeconds(0, 0)
                }

                const d = new Date();
                const testTime = getRandomDate();
                // const getNowTime = d.setSeconds(0, 0);
                const getNowTime = d.setMinutes(d.getMinutes() - 1);

                $.ajax({
                    url: '/action',
                    method: "POST",
                    data: { action: 'fetch' },
                    dataType: "JSON",
                    success: function (data) {
                        var html = '';

                        if (data.data.length >= 0) {
                            for (var count = 0; count < data.data.length; count++) {
                                const startDate = new Date(data.data[count].Start)
                                const lastDate = new Date(data.data[count].Last)
                                const time = dif(startDate, lastDate);
                                html += `
                            <tr onclick="showHideRow('hidden_row${count}');">
                                <td class="id-table table-id-hidden_row${count}">${data.data[count].id}</td>
                                <td class="repair-table">${lastDate.getTime() >= getNowTime ? '🟢' : '🔴'} <a href="https://app.asana.com/0/search?q=${data.data[count].Repair}" target="_blank">${data.data[count].Repair}</a></td>
                                <td class="health-table">${data.data[count].Health}%</td>
                                <td class="cycle-table">${data.data[count].Cycle}</td>
                                <td class="level-table">${data.data[count].Level}%</td>                           
                            </tr>
                            <tr id="hidden_row${count}" class="hidden_row">
                                <td class="hide-info" colspan=3 class="table-info"> <p>czas trwania:\v <span style="font-weight: bold">${time}</span></p> <p>typ testu:\v \v \v ${data.data[count].Comment} </p></td>
                                <td class="hide-time" colspan=2 class="table-start"><p> start:\v ${startDate.getHours()}:${startDate.getMinutes()} ${startDate.getDate()}-${startDate.getMonth()} </p> <p>last: \v ${lastDate.getHours()}:${lastDate.getMinutes()} ${lastDate.getDate()}-${lastDate.getMonth()}</p></td>
                            </tr>
                            `;
                            }
                        }
                        $('#sample_data tbody').html(html);
                    }
                });
            }

            $('#add_data').click(function () {

                $('#dynamic_modal_title').text('Add Data');

                $('#sample_form')[0].reset();

                $('#action').val('Add');

                $('#action_button').text('Add');

                $('#action_modal').modal('show');

            });

            $('#sample_form').on('submit', function (event) {

                event.preventDefault();

                $.ajax({
                    url: '/action',
                    method: "POST",
                    data: $('#sample_form').serialize(),
                    dataType: "JSON",
                    beforeSend: function () {
                        $('#action_button').attr('disabled', 'disabled');
                    },
                    success: function (data) {
                        $('#action_button').attr('disabled', false);

                        $('#message').html('<div class="alert alert-success">' + data.message + '</div>');

                        $('#action_modal').modal('hide');

                        load_data();
                        alert(data);
                        setTimeout(function () {
                            $('#message').html('');
                        }, 5000);
                    }
                });

            });

            $(document).on('click', '.edit', function () {

                var id = $(this).data('id');

                $('#dynamic_modal_title').text('Edit Data');

                $('#action').val('Edit');

                $('#action_button').text('Edit');

                $('#action_modal').modal('show');

                $.ajax({
                    url: '/action',
                    method: "POST",
                    data: { id: id, action: 'fetch_single' },
                    dataType: "JSON",
                    success: function (data) {
                        $('#id').val(data.id);
                        $('#Repair').val(data.Repair);
                        $('#Health').val(data.Health);
                        $('#Cycle').val(data.Cycle);
                        $('#Level').val(data.Level);
                        $('#Start').val(data.Start);
                        $('#Last').val(data.Last);
                        $('#Comment').val(data.Comment);
                    }
                });

            });

            $(document).on('click', '.delete', function () {

                var id = $(this).data('id');

                if (confirm("Are you sure you want to delete this data?")) {
                    $.ajax({
                        url: '/action',
                        method: "POST",
                        data: { action: 'delete', id: id },
                        dataType: "JSON",
                        success: function (data) {
                            $('#message').html('<div class="alert alert-success">' + data.message + '</div>');
                            load_data();
                            setTimeout(function () {
                                $('#message').html('');
                            }, 5000);
                        }
                    });
                }

            });


            $('#form_new').submit(function (event) {

                event.preventDefault()

                $('#action').val('Start');

                event.preventDefault();

                $.ajax({
                    url: '/action',
                    method: "POST",
                    data: $('#form_new').serialize(),
                    dataType: "JSON",

                    success: function (data) {
                        load_data();
                    }
                });

            });



            $('#form_update').submit(function (event) {

                event.preventDefault()

                $('#action').val('Update');

                event.preventDefault();

                $.ajax({
                    url: '/action',
                    method: "POST",
                    data: $('#form_update').serialize(),
                    dataType: "JSON",

                    success: function (data) {
                    }
                });

                load_data();

            });
            $(document).on('click', '#refresh', function () {
                load_data()
            });
        });
    </script>