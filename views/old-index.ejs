<!doctype html>
<style>

    /* reset css */
    body,div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,form,fieldset,input,textarea,p,blockquote,th,td { 
    margin:0;
    padding:0;
    }
    html,body {
        margin:0;
        padding:0;
        font-family: 'Roboto Mono', monospace;

    }
    table {
        border-collapse:collapse;
        border-spacing:0;
    }
    fieldset,img { 
        border:0;
    }
    input{
        border:1px solid #b0b0b0;
        padding:3px 5px 4px;
        color:#979797;
        width:190px;
    }
    address,caption,cite,code,dfn,th,var {
        font-style:normal;
        font-weight:normal;
    }
    ol,ul {
        list-style:none;
    }
    caption,th {
        text-align:left;
    }
    h1,h2,h3,h4,h5,h6 {
        font-size:100%;
        font-weight:normal;
    }
    /* end reset css */
/* ------------------------ */
    .content{
        width: 100%;
        /* display: flex;
        flex-wrap: wrap; */
        background-color: red;
        /* width: 500px; */
    }
/* ------------------------ */
    .benchmark{
        /* text-align: center; */
        /* float: left; */
        background-color: green;
        position: fixed;
        width: 50%;
        right: 0;

        /* padding: 20px; */
    }
    .local-player, .youtube-player {
        width: 100%;
        background-color: yellow;
    }
    .local-player video {
        width:100%;
        min-height: 280px;
    }
    .youtube-player iframe {
        width:100%;
        /* height: calc(100vw/1.77); */
        aspect-ratio: 16 / 9;
    }

/* ------------------------ */




    .table {
        /* width: 60%;
        overflow: auto; */
        height: 100%;
        right: 0;
        /* width: 100%; */
        background-color: #eeeeee;
        table-layout: auto;
        width: 100%;
        font-size: 1em;
        /* padding: 10px; */
    }
    .table table {
        table-layout: auto;
        width: 100%;
        /* padding: 10px; */
        /* border-spacing: 30px; */

    }
  
    .table-content th {
        text-align: center;
        padding: 8px;
        /* padding-left: 30px; */
        /* background-color: turquoise; */
        font-weight: bold;
    }
    .table-content th:last-child {
        padding-right: 30px;
    }
    .calc-button {
        width: 40px;
        height: 40px;
        margin-left: auto;
        margin-right: auto;
    }
    .table-content th:first-child {
        padding-left: 30px;
    }
    .table-content td {
        /* padding-left: 10px; */
    }
    .table-content tr:nth-child(2n+1) {
        background-color: #eeeeee;
        
    }
    .table-content tr {
        background-color: #bebebe;
        border-bottom: 1px solid black;
        /* margin: 20px; */
    }
    .table-id {
        /* background-color: white; */
        text-align: center;
        padding-left: 10px;
    }
    .table-repair, .table-health, .table-cycle {
        text-align: center;
        /* padding: 8px; */


    }
    .benchmark-forms {
        background-color: #e5e5e5;
        border-radius: 6px;
        display:flex;justify-content:center;align-items:center;
        flex-direction: column;
        margin-left: auto;
        margin-right: auto;
        margin-top: 30px;
        margin-bottom: 30px;
        padding: 15px 30px 22px;
        /* max-width: 460px; */
    }
    .benchmark-forms input {
        border: 1px solid black;
        /* background-color: white; */
        padding: 8px;
        margin: 0;
        width: 100%;
        font-size: 1em;
        color: black;
        box-sizing: border-box;

    }
    /* .benchmark-forms select {
        width: 100%;
        font-size: 1em;
        color: black;
        padding: 8px;
        border: 1px solid black;
        display: block;
        margin: 0;
    } */
    #Comment_select {
        /* background-color: yellow; */
        font-size: 1em;
        width: 100%;
        padding: 8px;
        line-height: 1;
        border: 1px solid black;

        /* margin-right: 2rem !important; */


        /* min-width: none; */
    }

    #Comment_input {
        /* background-color: yellow; */
        border-top: 0;
        font-size: 1em;
        height: 100%;
        padding: 8px;
        /* width: auto; */
        /* margin: 8px; */
    }

    /* .cycle , .health{
        box-sizing: border-box;
        display: block;
        border: 0;
        color: green ;
        font-size: 2em;
        float: left;
        background-color: red;
    } */
    .benchmark-forms input::placeholder {
        color: black;
    }
    #start_button {
        border-radius: 0;
        box-sizing: border-box;
        margin-top: 10px;
        font-size: 1.1em;
        color: black;
        border: 1px solid black;
        padding: 18px;
        background-color: white;
        width: 100%;
    }

/* ------------------------ */
    footer {
        background-color: turquoise;
        height: 3em;
    }


/* ------------------------ */


   
    @media only screen and (min-width: 992px) {
        .content {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-column-gap: 0px;
            grid-row-gap: 0px;
        }
        .benchmark {
            background-color:yellowgreen;
        }
    }

    
</style>
<html lang="en">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Bootstrap CSS -->
        <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

        <link href="https://cdn.datatables.net/1.12.0/css/dataTables.bootstrap5.min.css" rel="stylesheet"> -->

        <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

        <script src="https://cdn.datatables.net/1.12.0/js/jquery.dataTables.min.js"></script>

        <script src="https://cdn.datatables.net/1.12.0/js/dataTables.bootstrap5.min.js"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
        <title>BATAJ</title>
    </head>
    <body >
        <!-- <div id="message">
            <input id="iteration" value="0" >
        </div> -->
        <div class="content" >
            <div class="benchmark">
                <div class="benchmark-forms" >
                    <form method="post" id="form_new" >
                        <h6>Numer naprawy</h6>    
                        <input name="Repair" value="" placeholder="Numer naprawy" >                                           
                        <h6>Kondycja</h6>  
                        <input class="health"name="Health" type="number" value="100">                                         
                        <h6>Cykl</h6> 
                        <input class="cycle" name="Cycle"  type="number" value="0">    
                        <h6>Poziom naładowania</h6> 
                        <input class="cycle" name="Cycle"  type="number" value="100">                                                                 
                        <h6 >Komentarz</h6>                                             
                        <select onchange="move_Select()" id="Comment_select">
                            <option value="Cykl kalibracyjny">Cykl kalibracyjny</option>
                            <option value="Test stabilności">Test stabilności</option>
                            
                            <option value="">Inne</option>
                        </select>
                        <input name="Comment" id="Comment_input" >      
                        <input name="Start" value="" hidden>   
                        <input name="Last" value="" hidden>        
                        <input name="action" value="Start" hidden> 
                        <input type="submit" id="submit_new" value="new" hidden > 
                        <input type="button" value="Uruchom test" id="start_button" onclick="runner()">
                                                          
                    </form>
                    <form method="post" id="form_update" hidden >                        
                        <input id="current_id" name="id" value="0">
                        <input name="action" value="Now" hidden>  
                        <input type="submit" id="submit_update" value="update">
                    </form>  
                    <input type="button" id='refresh' value="refresh" hidden>
                    <input id="run"  value="0" hidden>
                    
                    <!-- <input type="" value="Uruchom test" id="start_button" onclick="runner()"> -->

                </div>

                <!-- <div id="button">
                    <input type="button" value="Uruchom test" id="start_button" onclick="runner()">
                </div> -->

                <div class="benchmark-video">
                    <div class="youtube-player">
                        <h1>Youtube Video</h1>
                        <iframe src="https://www.youtube.com/embed/a6GGZ68mOZA" title="seels 10 hours" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                    </div>
                    <div class="local-player">
                        <h1>Local Video</h1>
                        <video controls loop muted>
                            <source src="seals.mp4" type="video/mp4">
                        </video>
                    </div>
                </div>
               
            </div>

            <div class="table">
                <!-- <h1 class="mt-4 mb-4 text-center text-primary"><b>Batmark V2</b></h1> -->
                <!-- <span id="message"></span> -->
                <div class="table-content">
                    <!-- <div class="card-header">
                        <div class="row">
                            <div class="col col-sm-3">
                                <button type="button" id="add_data" class="btn btn-success btn-sm float-end">Add</button>
                            </div>
                        </div>
                    </div> -->
                    <table class="" id="sample_data">
                        <thead>
                            <tr>
                                <th>id</th>
                                <th>repair</th>
                                <th>health</th>
                                <th>cycle</th>
                                <th>start</th>
                                <th>last</th>
                                <th>info</th>  
                                <th>calc</th>                      
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>
    




<!-- 
        <div class="modal" tabindex="-1" id="action_modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <form method="post" id="sample_form">
                <div class="modal-header" id="dynamic_modal_title">
                    <h5 class="modal-title"></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">id</label>
                        <input type="text" name="id" id="id" class="form-control" />
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Repair</label>
                        <input type="text" name="Repair" id="Repair" class="form-control" />
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Health</label>
                        <input type="text" name="Health" id="Health" class="form-control" />
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Cycle</label>
                        <input type="text" name="Cycle" id="Cycle" class="form-control" />
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Start</label>
                        <input type="text" name="Start" id="Start" class="form-control" />
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Last</label>
                        <input type="text" name="Last" id="Last" class="form-control" />
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Comment</label>
                        <input type="text" name="Comment" id="Comment" class="form-control" />
                    </div>
                </div>
                <div class="modal-footer">
                    <input type="hidden" name="id" id="id" />
                    <input type="hidden" name="action" id="action" value="Add" />
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary" id="action_button">Add</button>
                </div> -->
            </form>
        </div>
    </div>
</div>

<footer>
    <span>stupka</span>
</footer>
</body>


<script>
   function move_Select(){
        var dropdown = document.getElementById("Comment_select")
        var input = document.getElementById("Comment_input")
        input.value = dropdown.value
        if(input.value==""){
       
            input.style = "visibility:visible"
        }
        else{
            
            input.style = "visibility:hidden"
        }
    }
    move_Select()
    function runner(){
        var mode = document.getElementById("run")
        var but = document.getElementById("start_button")

        if (mode.value == "1"){
            mode.value = 0
            but.style='background-color: red'
            but.value='Test zakończony, kliknij aby uruchomić ponownie'
        }
        else if (mode.value == "0") {
            mode.value = 1
            but.style='background-color: lime'
            but.value='Test trwa, kliknij aby zakońćzyć'
            document.getElementById("submit_new").click()
           
            
            timeout = setTimeout(update_id,3000);
            timeout = setTimeout(send,3000);
           
        }
    }

   function update_id(){
    //gets table
var oTable = document.getElementById('sample_data');

//gets rows of table
var rowLength = oTable.rows.length;

//loops through rows    


  //gets cells of current row  
   var oCells = oTable.rows.item(1).cells;

   //gets amount of cells of current row
   var cellLength = oCells.length;

   //loops through each cell in current row
      // get your cell info here

      var cellVal = oCells.item(0).innerHTML;
      document.getElementById("current_id").value = cellVal;
   }

       

    function send(){
       document.getElementById("submit_update").click()
       var i = document.getElementById("iteration").value 
       i++
        document.getElementById("iteration").value = i
       if(document.getElementById("run").value==1){
       timeout = setTimeout(send,3000);
    
    
       }
     
       
    }

    function autoload(){

        document.getElementById('refresh').click()
        timeout = setTimeout(autoload,3000);
    }
    
    autoload()

     
function dif(strt, now) {
strt = new Date(strt)
now = new Date(now)
var s = strt-now
// Pad to 2 or 3 digits, default is 2
function pad(n, z) {
  z = z || 2;
  return ('00' + n*-1).slice(-z);
}

var ms = s % 1000;
s = (s - ms) / 1000;
var secs = s % 60;
s = (s - secs) / 60;
var mins = s % 60;
var hrs = (s - mins) / 60;

alert(pad(hrs) + ':' + pad(mins) + ':' + pad(secs) + '.' + pad(ms, 3));
}
    
    </script>


<script>

    $(document).ready(function(){
    
        load_data();
    
        function load_data()
        {

                    var html = '';
    
  
                        for(var count = 0; count < 20; count++)
                        {
                            html += `
                            <tr>
                                <td class="table-id">1</td>
                                <td class="table-repair">12345</td>

                                <td class="table-health">100%</td>

                                <td class="table-cycle">26</td>

                                <td class="table-start">Apr 25 2023 12:43:20</td>

                                <td class="table-last">Apr 25 2023 18:49:21</td>
                                <td class="table-info">Cykl kalibracyjny</td>
                                <td class="table-calc"><button class="calc-button">hhh</button></td>

          
                            </tr>
                            `;
                        }
                    
    
                    $('#sample_data tbody').html(html);
                
            // $.ajax({
            //     url:"http://192.168.2.222:3000/action",
            //     method:"POST",
            //     data:{action:'fetch'},
            //     dataType : "JSON",
            //     success:function(data)
            //     {
            //         var html = '';
    
            //         if(data.data.length >= 0)
            //         {
            //             for(var count = 0; count < 10; count++)
            //             {
            //                 html += `
            //                 <tr>
            //                     <td>`+data.data[count].id+`</td>
            //                     <td>`+data.data[count].Repair+`</td>
            //                     <td>`+data.data[count].Health+`</td>
            //                     <td>`+data.data[count].Cycle+`</td>
            //                     <td>`+data.data[count].Start+`</td>
            //                     <td>`+data.data[count].Last+`</td>
            //                     <td>`+data.data[count].Comment+`</td>
            //                     <td><button type="button" onclick="dif('${data.data[count].Start}', '${data.data[count].Last}')">Oblicz czas</button>&nbsp;<button type="button" class="btn btn-warning btn-sm edit" data-id="`+data.data[count].id+`" hidden>Edit</button>&nbsp;<button type="button" class="btn btn-danger btn-sm delete" data-id="`+data.data[count].id+`" hidden>Delete</button></td>
            //                 </tr>
            //                 `;
            //             }
            //         }
    
            //         $('#sample_data tbody').html(html);
            //     }
            // });
        }
    
        $('#add_data').click(function(){
    
            $('#dynamic_modal_title').text('Add Data');
    
            $('#sample_form')[0].reset();
    
            $('#action').val('Add');
    
            $('#action_button').text('Add');
    
            $('#action_modal').modal('show');
    
        });
    
        $('#sample_form').on('submit', function(event){
    
            event.preventDefault();
    
            $.ajax({
                url:"http://192.168.2.222:3000/action",
                method:"POST",
                data:$('#sample_form').serialize(),
                dataType:"JSON",
                beforeSend:function(){
                    $('#action_button').attr('disabled', 'disabled');
                },
                success:function(data)
                {
                    $('#action_button').attr('disabled', false);
    
                    $('#message').html('<div class="alert alert-success">'+data.message+'</div>');
    
                    $('#action_modal').modal('hide');
                    
                    load_data();
                    alert(data);
                    setTimeout(function(){
                        $('#message').html('');
                    }, 5000);
                }
            });
    
        });
    
        $(document).on('click', '.edit', function(){
    
            var id = $(this).data('id');
    
            $('#dynamic_modal_title').text('Edit Data');
    
            $('#action').val('Edit');
    
            $('#action_button').text('Edit');
    
            $('#action_modal').modal('show');
    
            $.ajax({
                url:"http://192.168.2.222:3000/action",
                method:"POST",
                data:{id:id, action:'fetch_single'},
                dataType:"JSON",
                success:function(data)
                {
                    $('#id').val(data.id);
                    $('#Repair').val(data.Repair);
                    $('#Health').val(data.Health);
                    $('#Cycle').val(data.Cycle);
                    $('#Start').val(data.Start);
                    $('#Last').val(data.Last);
                    $('#Comment').val(data.Comment);
                }
            });
    
        });
    
        $(document).on('click', '.delete', function(){
    
            var id = $(this).data('id');
    
            if(confirm("Are you sure you want to delete this data?"))
            {
                $.ajax({           
                    url:"http://192.168.2.222:3000/action",
                    method:"POST",
                    data:{action:'delete', id:id},
                    dataType:"JSON",
                    success:function(data)
                    {
                        $('#message').html('<div class="alert alert-success">'+data.message+'</div>');
                        load_data();
                        setTimeout(function(){
                            $('#message').html('');
                        }, 5000);
                    }
                });
            }
    
        });

        
$('#form_new').submit(function(event){
   
        event.preventDefault()

            $('#action').val('Start');

            event.preventDefault();
    
            $.ajax({
                url:"http://192.168.2.222:3000/action",
                method:"POST",
                data:$('#form_new').serialize(),
                dataType:"JSON",
              
                success:function(data)
                {
                    load_data();
                }
            });
    
        });


                
$('#form_update').submit(function(event){
   
   event.preventDefault()

       $('#action').val('Update');

       event.preventDefault();

       $.ajax({
           url:"http://192.168.2.222:3000/action",
           method:"POST",
           data:$('#form_update').serialize(),
           dataType:"JSON",
         
           success:function(data)
           {
           }
       });
       
       load_data();
       

   });
   $(document).on('click', '#refresh', function(){
        load_data()
    });
     
          
            
        





    });
    
   

    </script>


